<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/style.css">
    <title>Teams</title>
    <script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
</head>
<style>

</style>

<body>
    <div class="container">
        {{>trnavbar}}
        <div id="content">
            <form>

                <p id="email">{{tremail}}</p>
                <h1>Create Team</h1>
                <label>Team Name: </label>
                <input type="text" name="team-name" required placeholder="Team Name">
                <label>Team Description</label>
                <input type="text" name="team-desc">
                <label>Add Students</label>
                <input type="text" name="team-mem">
                <button id="addMore">Add more Students</button>
                <button id="create" type="submit">Create</button>
            </form>
            <p id="message"></p>
        </div>
    </div>
    <script>
        document.getElementById("addMore").addEventListener("click", (e) => {
            e.preventDefault();
            console.log("clicked")
            content = document.getElementById("content");
            var ele = document.createElement("input");
            ele.setAttribute("name", "team-mem");
            content.appendChild(ele);
        })
        document.getElementById("create").addEventListener("click", (e) => {
            e.preventDefault();
            teamName = document.getElementsByName("team-name")[0].value;
            teamDesc = document.getElementsByName("team-desc")[0].value;
            teamMem = document.getElementsByName("team-mem");

            msg = document.getElementById("message");
            msg.innerText = "Creating team....";

            const teamData = {
                teamName,
                teamDesc
            }
            $.post("/create-team", teamData,
                function (data, status) {
                    console.log(data.message)
                    return false;
                });
            for (const it of teamMem) {
                const teamMem = {
                    teamName,
                    memb: it.value
                }
                $.post("/add-student", teamMem,
                function (data, status) {
                    console.log(data.message)
                    return false;
                });
            }
            const teacher = document.getElementById("email").textContent;
            const teacherData = {
                teamName,
                teacher
            }
            $.post("/add-teacher", teacherData,
                function (data, status) {
                    console.log(data.message)
                    return false;
                });
            msg.innerText = "Team created....";
            
        })
    </script>
</body>

</html>